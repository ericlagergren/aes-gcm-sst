#![cfg(test)]

use crate::AesGcm128Sst4;

#[test]
fn test_basic() {
    let key = [
        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e,
        0x0f,
    ];
    let nonce = [
        0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3a, 0x3b,
    ];
    let aead = AesGcm128Sst4::new(&key.into());
    let want = [0x9b, 0x1d, 0x49, 0xea];
    let got = aead
        .seal(&mut [], &nonce.into(), &[], &[])
        .expect("should be able to encrypt");
    assert_eq!(got, want.into());
}
